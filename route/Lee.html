<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>이순신 장군 발자취 예제</title>
    <script
      type="text/javascript"
      src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=9c9fb588b9138bcbd0cd56120ecc523d&libraries=services"
    ></script>
    <script>
      var map;
      var infowindow;
      var currentMarker = null;

      function initialize() {
        map = new kakao.maps.Map(document.getElementById("map"), {
          center: new kakao.maps.LatLng(34.7465, 127.7329),
          level: 12,
        });

        infowindow = new kakao.maps.InfoWindow({ zIndex: 1 });

        var places = [
          {
            name: "선소",
            latLng: new kakao.maps.LatLng(34.7592, 127.7223),
            img: "https://minio.nculture.org/amsweb-opt/multimedia_assets/31/85987/95269/c/%EC%97%AC%EC%88%98-%EC%84%A0%EC%86%8C%EC%9C%A0%EC%A0%81_%EB%B6%80%EC%82%B0%EC%A7%84%EC%88%9C%EC%A0%88%EB%8F%842_%EB%AC%B8%ED%99%94%EC%9E%AC%EC%B2%AD_%EC%A0%9C1%EC%9C%A0%ED%98%95-medium-size.jpg",
            desc: "조선시대 군선과 어선을 만들던 곳으로, 역사적인 배 제조 장소입니다.",
          },
          {
            name: "이충무공자당기거지",
            latLng: new kakao.maps.LatLng(34.7512, 127.7306),
            img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSgfPerM4B9CACJ0h2QOo9K1oHYUoYuj_XaJQ&s",
            desc: "이순신 장군의 가족이 살던 옛집으로 역사적인 의미가 깊습니다.",
          },
          {
            name: "진남관",
            latLng: new kakao.maps.LatLng(34.7542, 127.7322),
            img: "https://lh5.googleusercontent.com/proxy/mKMMukQIt03gZriA98aHrVQstZy03tsmwl1s74xpumlfl8fY1A3cPrrk3j5ArHjTZQ1UFJO32NRW7_YYkvq67oZZT1LyhnohDOlKcZ28cpv1vg6jilr2lPdFI6iQ0yJ-R-M",
            desc: "전라좌수영의 중심지였던 조선시대 건축물입니다.",
          },
          {
            name: "이순신광장",
            latLng: new kakao.maps.LatLng(34.7465, 127.7329),
            img: "https://mblogthumb-phinf.pstatic.net/MjAyMzA5MTNfMTA2/MDAxNjk0NTk3NDEyOTQ3.6Fe7mVk0Z65bd8kOp8tZ9htaPWh2nmvlo51SX3xLM30g.qnkQ7DQ1nJo7pURNIBjI4SeJSyibxr1xITBeMxQCoxsg.JPEG.suk4408/061A8464.jpg?type=w800",
            desc: "이순신 장군을 기리는 동상이 있는 광장으로 관광 명소입니다.",
          },
          {
            name: "고소동천사벽화골목",
            latLng: new kakao.maps.LatLng(34.7489, 127.7432),
            img: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR6IrmSDE50rTZ1yQSmG_O4byAX_CfbcSY2jw&s",
            desc: "형형색색의 벽화가 있는 골목으로 사진 찍기 좋은 장소입니다.",
          },
        ];

        var bounds = new kakao.maps.LatLngBounds();
        places.forEach(function (place) {
          bounds.extend(place.latLng);
        });
        map.setBounds(bounds);

        var path = places.map(function (place) {
          return place.latLng;
        });

        var polyline = new kakao.maps.Polyline({
          path: path,
          strokeWeight: 5,
          strokeColor: "#FF0000",
          strokeOpacity: 1,
          strokeStyle: "solid",
        });
        polyline.setMap(map);

        places.forEach(function (place) {
          var marker = new kakao.maps.Marker({
            position: place.latLng,
            map: map,
          });

          kakao.maps.event.addListener(marker, "click", function () {
            if (infowindow.getMap() && currentMarker === marker) {
              infowindow.close();
              currentMarker = null;
            } else {
              var content =
                '<div style="padding:10px; width:250px; height:300px;">' +
                "<strong>" +
                place.name +
                "</strong><br>" +
                '<img src="' +
                place.img +
                '" style="width:100%; height:auto; max-height:150px; margin-top:5px;"><br>' +
                "<p style='margin-top:5px;'>" +
                place.desc +
                "</p></div>";

              infowindow.setContent(content);
              infowindow.open(map, marker);
              currentMarker = marker;
            }
          });
        });

        kakao.maps.event.addListener(map, "click", function () {
          infowindow.close();
          currentMarker = null;
        });
      }

      window.onload = initialize;
    </script>
  </head>
  <body>
    <a href="../main.html">메인</a>

    <div id="map" style="width: 100%; height: 600px"></div>
  </body>
</html>
